

Listen 1081
<VirtualHost *:1081>
Include /opt/logicmoo_workspace/packs_web/logicmoo_webui/etc/apache2/conf-available/doc_root_ssl.conf
RewriteCond %{HTTP:UPGRADE} ^WebSocket$   [NC]
RewriteCond %{HTTP:CONNECTION} ^Upgrade$ [NC]
RewriteRule .* ws://localhost:1082%{REQUEST_URI} [P,L]
ProxyPass / http://logicmoo.org:1082/                          
ProxyPassReverse / http://logicmoo.org:1082/
ProxyPassReverse / https://logicmoo.org:1082/
</VirtualHost>


Listen 1080
<VirtualHost *:1080>
Include /opt/logicmoo_workspace/packs_web/logicmoo_webui/etc/apache2/conf-available/doc_root_ssl.conf
RewriteCond %{HTTP:UPGRADE} ^WebSocket$   [NC]
RewriteCond %{HTTP:CONNECTION} ^Upgrade$ [NC]
RewriteRule .* ws://localhost:1082%{REQUEST_URI} [P,L]
ProxyPass / http://logicmoo.org:1082/                          
ProxyPassReverse / http://logicmoo.org:1082/
ProxyPassReverse / https://logicmoo.org:1082/
</VirtualHost>


Listen 4080
<VirtualHost *:4080>
Include /opt/logicmoo_workspace/packs_web/logicmoo_webui/etc/apache2/conf-available/doc_root_ssl.conf
# This checks to make sure the connection is not already HTTPS
#RewriteCond %{HTTPS} !=on
#RewriteRule ^/?(.*) https://%{SERVER_NAME}:1081/$1 [R,L]
RewriteCond %{HTTP:UPGRADE} ^WebSocket$   [NC]
RewriteCond %{HTTP:CONNECTION} ^Upgrade$ [NC]
RewriteRule .* ws://localhost:1082%{REQUEST_URI} [P,L]
ProxyPass / http://logicmoo.org:1082/                          
ProxyPassReverse / http://logicmoo.org:1082/
ProxyPassReverse / https://logicmoo.org:1082/
</VirtualHost>


Listen 13904 
<VirtualHost *:13904>
Include /opt/logicmoo_workspace/packs_web/logicmoo_webui/etc/apache2/conf-available/doc_root_ssl.conf
RewriteCond %{HTTP:UPGRADE} ^WebSocket$   [NC]
RewriteCond %{HTTP:CONNECTION} ^Upgrade$ [NC]
RewriteRule .* ws://localhost:3904%{REQUEST_URI} [P,L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule "^/(.*)" "http://localhost:3904/$1" [P,L]
</VirtualHost>


Listen 13100 
<VirtualHost *:13100>
Include /opt/logicmoo_workspace/packs_web/logicmoo_webui/etc/apache2/conf-available/doc_root_ssl.conf
RewriteCond %{HTTP:UPGRADE} ^WebSocket$   [NC]
RewriteCond %{HTTP:CONNECTION} ^Upgrade$ [NC]
RewriteRule .* ws://localhost:3100%{REQUEST_URI} [P,L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule "^/(.*)" "http://localhost:3100/$1" [P,L]
</VirtualHost>


Listen 13101 
<VirtualHost *:13101>
Include /opt/logicmoo_workspace/packs_web/logicmoo_webui/etc/apache2/conf-available/doc_root_ssl.conf
RewriteCond %{HTTP:UPGRADE} ^WebSocket$   [NC]
RewriteCond %{HTTP:CONNECTION} ^Upgrade$ [NC]
RewriteRule .* ws://localhost:3101%{REQUEST_URI} [P,L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule "^/(.*)" "http://localhost:3101/$1" [P,L]
</VirtualHost>


Listen 8181 
<VirtualHost *:8181>
Include /opt/logicmoo_workspace/packs_web/logicmoo_webui/etc/apache2/conf-available/doc_root_ssl.conf
RewriteCond %{HTTP:UPGRADE} ^WebSocket$   [NC]
RewriteCond %{HTTP:CONNECTION} ^Upgrade$ [NC]
RewriteRule .* ws://localhost:8282%{REQUEST_URI} [P,L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule "^/(.*)" "http://localhost:8282/$1" [P,L]
</VirtualHost>


Listen 13123 
<VirtualHost *:13123>
Include /opt/logicmoo_workspace/packs_web/logicmoo_webui/etc/apache2/conf-available/doc_root_ssl.conf
RewriteCond %{HTTP:UPGRADE} ^WebSocket$   [NC]
RewriteCond %{HTTP:CONNECTION} ^Upgrade$ [NC]
RewriteRule .* ws://localhost:3123%{REQUEST_URI} [P,L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule "^/(.*)" "http://localhost:3123/$1" [P,L]
</VirtualHost>


Listen 13103 
<VirtualHost *:13103>
Include /opt/logicmoo_workspace/packs_web/logicmoo_webui/etc/apache2/conf-available/doc_root_ssl.conf
RewriteCond %{HTTP:UPGRADE} ^WebSocket$   [NC]
RewriteCond %{HTTP:CONNECTION} ^Upgrade$ [NC]
RewriteRule .* ws://localhost:3103%{REQUEST_URI} [P,L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule "^/(.*)" "http://localhost:3103/$1" [P,L]
</VirtualHost>


Listen 4020
<VirtualHost *:4020>
Include /opt/logicmoo_workspace/packs_web/logicmoo_webui/etc/apache2/conf-available/doc_root_ssl.conf
ProxyPass / http://logicmoo.org:3020/
ProxyPassReverse / http://logicmoo.org:3020/
</VirtualHost>

#ServerSignature Off
# This will enable the Rewrite capabilities
#
# This checks to make sure the connection is not already HTTPS
#RewriteCond %{HTTPS} !=on
#RewriteRule ^/?(.*) https://%{SERVER_NAME}/$1 [NE, R,L]


Listen 4088
<VirtualHost *:4088>
Include /opt/logicmoo_workspace/packs_web/logicmoo_webui/etc/apache2/conf-available/doc_root.conf
#DirectoryIndex index.html index.htm index.php welcome.html
Include /etc/apache2/conf-available/cliopatria_swish.conf
</VirtualHost>


Listen 9443
<VirtualHost *:9443>
Include /opt/logicmoo_workspace/packs_web/logicmoo_webui/etc/apache2/conf-available/doc_root_ssl.conf
#Options -Indexes
SSLProtocol             all -SSLv2 -SSLv3
SSLCipherSuite ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA:ECDHE-RSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-RSA-AES256-SHA256:DHE-RSA-AES256-SHA:ECDHE-ECDSA-DES-CBC3-SHA:ECDHE-RSA-DES-CBC3-SHA:EDH-RSA-DES-CBC3-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:DES-CBC3-SHA:!DSS
SSLHonorCipherOrder     on
# Encoded slashes need to be allowed
AllowEncodedSlashes NoDecode
# Container uses a unique non-signed certificate
SSLProxyVerify None
SSLProxyCheckPeerCN Off
SSLProxyCheckPeerName Off
  # static html, js, images, etc. served from loolwsd
  # loleaflet is the client part of Collabora Online
  ProxyPass           /loleaflet https://127.0.0.1:9980/loleaflet retry=0
  ProxyPassReverse    /loleaflet https://127.0.0.1:9980/loleaflet
  # WOPI discovery URL
  ProxyPass           /hosting/discovery https://127.0.0.1:9980/hosting/discovery retry=0
  ProxyPassReverse    /hosting/discovery https://127.0.0.1:9980/hosting/discovery
  # Capabilities
  ProxyPass           /hosting/capabilities https://127.0.0.1:9980/hosting/capabilities retry=0
  ProxyPassReverse    /hosting/capabilities https://127.0.0.1:9980/hosting/capabilities
  # Main websocket
  ProxyPassMatch "/lool/(.*)/ws$" wss://127.0.0.1:9980/lool/$1/ws nocanon
  # Admin Console websocket
  ProxyPass   /lool/adminws wss://127.0.0.1:9980/lool/adminws
  # Download as, Fullscreen presentation and Image upload operations
  ProxyPass           /lool https://127.0.0.1:9980/lool
  ProxyPassReverse    /lool https://127.0.0.1:9980/lool
</VirtualHost>

