
RewriteEngine On

<IfModule mime_module>
   AddType text/html .php .phps
</IfModule>

# SetEnvIfNoCase User-Agent "DuckDuckGo|Abonti|aggregator|AhrefsBot|asterias|BDCbot|BLEXBot|BuiltBotTough|Bullseye|BunnySlippers|ca\-crawler|CCBot|Cegbfeieh|CheeseBot|CherryPicker|CopyRightCheck|cosmos|Crescent|discobot|DittoSpyder|DotBot|Download Ninja|EasouSpider|EmailCollector|EmailSiphon|EmailWolf|EroCrawler|Exabot|ExtractorPro|Fasterfox|FeedBooster|Foobot|Genieo|grub\-client|Harvest|hloader|httplib|HTTrack|humanlinks|ieautodiscovery|InfoNaviRobot|IstellaBot|Java/1\.|JennyBot|k2spider|Kenjin Spider|Keyword Density/0\.9|larbin|LexiBot|libWeb" bad_bot
SetEnvIfNoCase User-Agent "LinkextractorPro|linko|LinkScan/8\.1a Unix|LinkWalker|LNSpiderguy|lwp\-trivial|magpie|Mata Hari|MaxPointCrawler|MegaIndex|Microsoft URL Control|MIIxpc|Mippin|Missigua Locator|Mister PiX|MJ12bot|moget|MSIECrawler|NetAnts" bad_bot
# SetEnvIfNoCase User-Agent "NICErsPRO|Niki\-Bot|NPBot|Nutch|Offline Explorer|Openfind|panscient\.com|PHP/5\.\{|ProPowerBot/2\.14|ProWebWalker|Python\-urllib|QueryN Metasearch|RepoMonkey|RMA|SemrushBot|SeznamBot|SISTRIX|sitecheck\.Internetseer\.com|SiteSnagger|SnapPreviewBot|Sogou|SpankBot|spanner|spbot|Spinn3r|suzuran|Szukacz/1\.4|Teleport|Telesoft|The Intraformant|TheNomad|TightTwatBot|Titan|toCrawl/UrlDispatcher|True_Robot|turingos|TurnitinBot|UbiCrawler|UnisterBot|URLy Warning|VCI|WBSearchBot|Web Downloader/6\.9|Web Image Collector|WebAuto|WebBandit|WebCopier|WebEnhancer|WebmasterWorldForumBot|WebReaper|WebSauger|Website Quester|Webster Pro|WebStripper|WebZip|Wotbox|wsr\-agent|WWW\-Collector\-E|Xenu|Zao|Zeus|ZyBORG|coccoc|Incutio|lmspider|memoryBot|SemrushBot|serf|Unknown|uptime files" bad_bot

RewriteCond %{SERVER_PORT} !4088
RewriteCond %{SERVER_PORT} 4088
RewriteCond %{REQUEST_URI} ^CONNECT 
RewriteRule (.*) /docs/?url=$1 [L]

RewriteCond %{SERVER_PORT} !4088
RewriteCond %{SERVER_PORT} 4088
RewriteCond %{ENV:bad_bot} 1 [OR]
RewriteCond %{HTTP_USER_AGENT} AltaVista [OR]
RewriteCond %{HTTP_USER_AGENT} Googlebot [OR]
RewriteCond %{HTTP_USER_AGENT} crawler [OR]
RewriteCond %{HTTP_USER_AGENT} msnbot [OR]
RewriteCond %{HTTP_USER_AGENT} Slurp
RewriteCond %{REQUEST_URI} !txt
RewriteCond %{REQUEST_URI} !doc
RewriteCond %{REQUEST_URI} !html
RewriteCond %{REQUEST_URI} !pdf
RewriteCond %{REQUEST_URI} !rolog
RewriteCond %{REQUEST_URI} !icon
RewriteCond %{REQUEST_URI} !js
RewriteCond %{REQUEST_URI} !htm
RewriteCond %{REQUEST_URI} !jpg
RewriteCond %{REQUEST_URI} !gif
RewriteCond %{REQUEST_URI} !"="
RewriteCond %{REQUEST_URI} !"?"
RewriteCond %{REQUEST_URI} !eme
RewriteRule (.*) /docs/?url=$1 [L]

#RewriteCond   "$1.php"           -f
#RewriteCond   "$1.html"          !-f
#RewriteRule   "^(.*).html$"      "$1.php"

 
#DirectoryIndex index.html index.htm index.php welcome.html

#Options +ExecCGI -MultiViews +SymLinksIfOwnerMatch IncludesNoExec Limit SymLinksIfOwnerMatch IncludesNoExec
Options Indexes FollowSymLinks  MultiViews 
# FileInfo AuthConfig Includes

SetOutputFilter INCLUDES
AcceptPathInfo On


<Directory />    
  Options +Indexes +FollowSymLinks +Includes +MultiViews
  AllowOverride all
  IndexOptions FancyIndexing HTMLTable
</Directory>
<Directory /opt/logicmoo_workspace/~html~/>
  Options +Indexes +FollowSymLinks +Includes +MultiViews
  AllowOverride all
  IndexOptions FancyIndexing HTMLTable
</Directory>

<Directory /var/www/html/>
  Options +Indexes
  AllowOverride all
  IndexOptions FancyIndexing HTMLTable
</Directory>

# Ensure that encoded slashes are not decoded but left in their encoded state.                                                                                                                                                                                                    
# http://doc.gitlab.com/ce/api/projects.html#get-single-project                                                                                                                                                                                                                   
#AllowEncodedSlashes NoDecode

ProxyPass /xwiki http://localhost:18080/xwiki
ProxyPassReverse /xwiki http://localhost:18080/xwiki

ProxyPass /dokuwiki http://localhost:18088/dokuwiki
ProxyPassReverse /dokuwiki http://localhost:18088/dokuwiki


ProxyPass /home http://localhost:3020/home
ProxyPass /cpack http://localhost:3020/cpack
ProxyPass /admin http://localhost:3020/admin
ProxyPass /yasgui http://localhost:3020/yasgui
ProxyPass /help http://localhost:3020/help
ProxyPass /user http://localhost:3020/user
ProxyPass /browse http://localhost:3020/browse
ProxyPass /filesystem http://localhost:3020/filesystem
ProxyPass /node_modules http://localhost:3020/node_modules
ProxyPass /ace http://localhost:3020/ace
#ProxyPass /icons http://localhost:3020/icons
ProxyPass /pengine http://localhost:3020/pengine
#ProxyPass /pldoc http://localhost:3020/swish/pldoc
ProxyPass /plweb http://localhost:3020/plweb
ProxyPass /servlets http://localhost:3020/servlets
ProxyPass /swish http://localhost:3020/swish
ProxyPass /icons http://localhost:3020/icons
ProxyPass /opt http://localhost:3020/opt
ProxyPass /oauth2/google http://localhost:3020/oauth2/google

ProxyPassReverse /swish/icons http://localhost:3020/icons
ProxyPassReverse / http://localhost:3020
ProxyPassReverse / http://logicmoo.org:3020

#ProxyPassReverse / https://www.logicmoo.org
#ProxyPassReverse / http://www.logicmoo.org
ProxyPassReverse / https://www.swi-prolog.org
ProxyPassReverse / https://edu.swi-prolog.org
ProxyPassReverse / http://www.swi-prolog.org
ProxyPassReverse / http://edu.swi-prolog.org

#ProxyPass /filesystems http://localhost:3020/filesystems
#ProxyPass /e http://localhost:3020/e
#ProxyPass /p/ http://localhost:3020/p/
#ProxyPass /help http://localhost:3020/help


RewriteCond %{HTTP:UPGRADE} ^WebSocket$   [NC]
RewriteCond %{HTTP:CONNECTION} ^Upgrade$ [NC]
RewriteCond %{REQUEST_URI} !^/lool/.*
RewriteRule .* ws://localhost:3020%{REQUEST_URI} [P,L]

Header always set X-Frame-Options "SAMEORIGIN"


Alias "/wiki" "/var/lib/mediawiki/"

ProxyPass /gitlab http://logicmoo.org:1082/gitlab
ProxyPassReverse /gitlab http://logicmoo.org:1082/gitlab
#ProxyPass /gitlab/ http://logicmoo.org:1082/gitlab/                          
#ProxyPassReverse /gitlab http://logicmoo.org:1082/gitlab
#ProxyPassReverse /gitlab http://logicmoo.org:1082
#ProxyPassReverse /gitlab https://logicmoo.org:1082/gitlab
#ProxyPassReverse /gitlab https://logicmoo.org:1082



#ProxyPassReverse /wiki/ http://wiki.cyc.com/wiki
#ProxyPassReverse /wiki/ http://wiki.cyc.com


#ProxyPassReverse / http://localhost:4088
#ProxyPassReverse / http://logicmoo.org:4088

#RewriteCond "%{ENV:rewritten}" "!=1"
#RewriteCond "%{ENV:rewritten}" "!1"
RewriteCond %{SERVER_PORT} !4088
RewriteCond %{SERVER_PORT} 4088
#RewriteCond %{SERVER_PORT} !443
#RewriteCond %{SERVER_PORT} !80
RewriteCond %{SERVER_PORT} !"^4088$"
RewriteCond %{REQUEST_URI} !^/wordpress.*
RewriteCond %{REQUEST_URI} !^/shindig.*
RewriteCond %{REQUEST_URI} !^/gitlab.*
RewriteCond %{REQUEST_URI} !^/wiki.*
RewriteCond %{REQUEST_URI} !^/lool/.*
RewriteCond %{REQUEST_URI} !^/loleaflet.*
RewriteCond %{REQUEST_URI} !^/hosting/.*
#RewriteCond %{REQUEST_URI} !^/port.*
RewriteCond %{REQUEST_URI} !^/$
RewriteCond %{REQUEST_URI} !^/doku.*
RewriteCond %{REQUEST_URI} !^/mydoku.*
RewriteCond %{REQUEST_URI} !^/favicon.*
RewriteCond %{REQUEST_URI} !^/was_site/.*
RewriteCond %{REQUEST_URI} !^/index.html
RewriteCond %{REQUEST_URI} !^/privacy.html
RewriteCond %{REQUEST_URI} !^/.*/
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-l
RewriteRule "^/(.*)" "http://localhost:4088/$1" [P,L,E=rewritten:1,E=url:$1,QSA]
#RewriteRule "^/(.*)" "http://localhost:4088/$1" [P,L,QSA]



