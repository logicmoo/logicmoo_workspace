grammar usr_domain_lamps_sem, usr_domain_lamps_svenska, usr_domain_lamps_english of usr_domain_lamps ;
concrete usr_domain_lamps_sem of usr_domain_lamps = userCorePro, sharedDomainPro ** {flags coding = utf8 ;flags modulesize = n79 ;Acc_ICM in sharedCorePro ;
Acc_ICM_Followed in sharedCorePro ;
Action in sharedCorePro ;
Answer in sharedCorePro ;
AnswerList in userCorePro ;
Ask in sharedCorePro ;
CompoundedAsk in userCorePro ;
CompoundedRequest in userCorePro ;
DMove in sharedCorePro ;
Greet in sharedCorePro ;
ICM in sharedCorePro ;
Lamp in LampsPro ;
NegAnswer in sharedCorePro ;
Per_ICM in sharedCorePro ;
Per_ICM_Followed in sharedCorePro ;
Proposition in sharedCorePro ;
Quit in sharedCorePro ;
Request in sharedCorePro ;
Room in RoomsPro ;
S in sharedCorePro ;
SingleAction in sharedCorePro ;
SingleAsk in sharedCorePro ;
Task in sharedCorePro ;
acc_neg in sharedCorePro ;
acc_neg_alone in sharedCorePro ;
acc_pos in sharedCorePro ;
lin answerLampLocTurnOff : usr_domain_lamps.AnswerList = \ Lamp @ 0, Room @ 1 -> {s = "answer(lamp(" ++ (Lamp @ 0.s ++ (")," ++ ("answer(loc(" ++ (Room @ 1.s ++ ")")))) } ;"answer(lamp( Lamp_0 ), answer(loc( Room_1 )" ;
lin answerLampLocTurnOn : usr_domain_lamps.AnswerList = \ Lamp @ 0, Room @ 1 -> {s = "answer(lamp(" ++ (Lamp @ 0.s ++ (")," ++ ("answer(loc(" ++ (Room @ 1.s ++ ")")))) } ;"answer(lamp( Lamp_0 ), answer(loc( Room_1 )" ;
answerLampOff in sharedDomainPro ;
answerLampOn in sharedDomainPro ;
answerLocation in sharedDomainPro ;
askStatusLamp in sharedDomainPro ;
bedroom in RoomsPro ;
bye_command in sharedCorePro ;
ceilinglamp in LampsPro ;
desklamp in LampsPro ;
dimmerDown in sharedDomainPro ;
dimmerUp in sharedDomainPro ;
floorlamp in LampsPro ;
greet_command in sharedCorePro ;
hall in RoomsPro ;
help_command in sharedCorePro ;
kitchen in RoomsPro ;
livingroom in RoomsPro ;
makeAnswer in sharedCorePro ;
makeAnswerListS in userCorePro ;
makeAnswerMove in sharedCorePro ;
makeAsk in sharedCorePro ;
makeAskMove in userCorePro ;
makeCompoundedAsk in userCorePro ;
makeCompoundedRequest in userCorePro ;
makeGreetMove in sharedCorePro ;
makeICMAcc in sharedCorePro ;
makeICMMove in sharedCorePro ;
makeICMPer in sharedCorePro ;
makeNegAnswer in sharedCorePro ;
makeNegAnswerMove in sharedCorePro ;
makeQuitMove in sharedCorePro ;
makeRequest in sharedCorePro ;
makeRequestMove in sharedCorePro ;
makeS in sharedCorePro ;
no in sharedCorePro ;
per_int in sharedCorePro ;
per_neg in sharedCorePro ;
per_pos in sharedCorePro ;
questionLocation in sharedDomainPro ;
questionWhichLamp in sharedDomainPro ;
requestCompounded in userCorePro ;
requestCompoundedMulti in userCorePro ;
singleAsk in sharedCorePro ;
tablelamp in LampsPro ;
top_command in sharedCorePro ;
turnOff in sharedDomainPro ;
turnOffThis in sharedDomainPro ;
turnOff_alone in sharedDomainPro ;
turnOn in sharedDomainPro ;
turnOnThis in sharedDomainPro ;
turnOn_alone in sharedDomainPro ;
yes in sharedCorePro ;
}
concrete userCorePro of userCore = sharedCorePro ** {flags coding = utf8 ;flags modulesize = n53 ;flags lexer = code ;flags unlexer = concat ;flags conversion = finite ;Acc_ICM in sharedCorePro ;
Acc_ICM_Followed in sharedCorePro ;
Action in sharedCorePro ;
Answer in sharedCorePro ;
lincat AnswerList = {s : Str }= {s = str @ 0 } ;"AnswerList" ;
Ask in sharedCorePro ;
lincat CompoundedAsk = {s : Str }= {s = str @ 0 } ;"CompoundedAsk" ;
lincat CompoundedRequest = {s : Str }= {s = str @ 0 } ;"CompoundedRequest" ;
DMove in sharedCorePro ;
Greet in sharedCorePro ;
ICM in sharedCorePro ;
NegAnswer in sharedCorePro ;
Per_ICM in sharedCorePro ;
Per_ICM_Followed in sharedCorePro ;
Proposition in sharedCorePro ;
Quit in sharedCorePro ;
Request in sharedCorePro ;
S in sharedCorePro ;
SingleAction in sharedCorePro ;
SingleAsk in sharedCorePro ;
Task in sharedCorePro ;
acc_neg in sharedCorePro ;
acc_neg_alone in sharedCorePro ;
acc_pos in sharedCorePro ;
bye_command in sharedCorePro ;
greet_command in sharedCorePro ;
help_command in sharedCorePro ;
makeAnswer in sharedCorePro ;
lin makeAnswerListS : userCore.DMove = \ Task @ 0, AnswerList @ 1 -> {s = AnswerList @ 1.s } ;"AnswerList_1" ;
makeAnswerMove in sharedCorePro ;
makeAsk in sharedCorePro ;
lin makeAskMove : userCore.CompoundedAsk = \ Task @ 0, Ask @ 1, Answer @ 2 -> {s = "ask" ++ ("(" ++ ("X" ++ ("^" ++ (Ask @ 1.s ++ ("(" ++ ("X" ++ (")" ++ (")," ++ Answer @ 2.s)))))))) } ;"ask ( X ^ Ask_1 ( X ) ), Answer_2" ;
lin makeCompoundedAsk : userCore.DMove = \ CompoundedAsk @ 0 -> {s = CompoundedAsk @ 0.s } ;"CompoundedAsk_0" ;
lin makeCompoundedRequest : userCore.DMove = \ CompoundedRequest @ 0 -> {s = CompoundedRequest @ 0.s } ;"CompoundedRequest_0" ;
makeGreetMove in sharedCorePro ;
makeICMAcc in sharedCorePro ;
makeICMMove in sharedCorePro ;
makeICMPer in sharedCorePro ;
makeNegAnswer in sharedCorePro ;
makeNegAnswerMove in sharedCorePro ;
makeQuitMove in sharedCorePro ;
makeRequest in sharedCorePro ;
makeRequestMove in sharedCorePro ;
makeS in sharedCorePro ;
no in sharedCorePro ;
per_int in sharedCorePro ;
per_neg in sharedCorePro ;
per_pos in sharedCorePro ;
lin requestCompounded : userCore.CompoundedRequest = \ Task @ 0, Action @ 1, Answer @ 2 -> {s = "request(" ++ (Action @ 1.s ++ (")," ++ Answer @ 2.s)) } ;"request( Action_1 ), Answer_2" ;
lin requestCompoundedMulti : userCore.CompoundedRequest = \ Task @ 0, Action @ 1, AnswerList @ 2 -> {s = "request(" ++ (Action @ 1.s ++ (")," ++ AnswerList @ 2.s)) } ;"request( Action_1 ), AnswerList_2" ;
singleAsk in sharedCorePro ;
top_command in sharedCorePro ;
yes in sharedCorePro ;
}
concrete sharedDomainPro of sharedDomain = sharedCorePro, DBPro ** {flags coding = utf8 ;flags modulesize = n68 ;Acc_ICM in sharedCorePro ;
Acc_ICM_Followed in sharedCorePro ;
Action in sharedCorePro ;
Answer in sharedCorePro ;
Ask in sharedCorePro ;
DMove in sharedCorePro ;
Greet in sharedCorePro ;
ICM in sharedCorePro ;
Lamp in LampsPro ;
NegAnswer in sharedCorePro ;
Per_ICM in sharedCorePro ;
Per_ICM_Followed in sharedCorePro ;
Proposition in sharedCorePro ;
Quit in sharedCorePro ;
Request in sharedCorePro ;
Room in RoomsPro ;
S in sharedCorePro ;
SingleAction in sharedCorePro ;
SingleAsk in sharedCorePro ;
Task in sharedCorePro ;
acc_neg in sharedCorePro ;
acc_neg_alone in sharedCorePro ;
acc_pos in sharedCorePro ;
lin answerLampOff : sharedDomain.Proposition = \ Lamp @ 0 -> {s = Lamp @ 0.s } ;"Lamp_0" ;
lin answerLampOn : sharedDomain.Proposition = \ Lamp @ 0 -> {s = Lamp @ 0.s } ;"Lamp_0" ;
lin answerLocation : sharedDomain.Proposition = \ Room @ 0 -> {s = Room @ 0.s } ;"Room_0" ;
lin askStatusLamp : sharedDomain.SingleAsk = \ -> {s = "status" } ;"status" ;
bedroom in RoomsPro ;
bye_command in sharedCorePro ;
ceilinglamp in LampsPro ;
desklamp in LampsPro ;
lin dimmerDown : sharedDomain.SingleAction = \ -> {s = "dimmer_down" } ;"dimmer_down" ;
lin dimmerUp : sharedDomain.SingleAction = \ -> {s = "dimmer_up" } ;"dimmer_up" ;
floorlamp in LampsPro ;
greet_command in sharedCorePro ;
hall in RoomsPro ;
help_command in sharedCorePro ;
kitchen in RoomsPro ;
livingroom in RoomsPro ;
makeAnswer in sharedCorePro ;
makeAnswerMove in sharedCorePro ;
makeAsk in sharedCorePro ;
makeGreetMove in sharedCorePro ;
makeICMAcc in sharedCorePro ;
makeICMMove in sharedCorePro ;
makeICMPer in sharedCorePro ;
makeNegAnswer in sharedCorePro ;
makeNegAnswerMove in sharedCorePro ;
makeQuitMove in sharedCorePro ;
makeRequest in sharedCorePro ;
makeRequestMove in sharedCorePro ;
makeS in sharedCorePro ;
no in sharedCorePro ;
per_int in sharedCorePro ;
per_neg in sharedCorePro ;
per_pos in sharedCorePro ;
lin questionLocation : sharedDomain.Proposition = \ Room @ 0 -> {s = Room @ 0.s } ;"Room_0" ;
lin questionWhichLamp : sharedDomain.Proposition = \ Lamp @ 0 -> {s = Lamp @ 0.s } ;"Lamp_0" ;
singleAsk in sharedCorePro ;
tablelamp in LampsPro ;
top_command in sharedCorePro ;
lin turnOff : sharedDomain.Action = \ -> {s = "turnOff" } ;"turnOff" ;
lin turnOffThis : sharedDomain.SingleAction = \ -> {s = "turnOff_closest" } ;"turnOff_closest" ;
lin turnOff_alone : sharedDomain.SingleAction = \ -> {s = "turnOff" } ;"turnOff" ;
lin turnOn : sharedDomain.Action = \ -> {s = "turnOn" } ;"turnOn" ;
lin turnOnThis : sharedDomain.SingleAction = \ -> {s = "turnOn_closest" } ;"turnOn_closest" ;
lin turnOn_alone : sharedDomain.SingleAction = \ -> {s = "turnOn" } ;"turnOn" ;
yes in sharedCorePro ;
}
concrete sharedCorePro of sharedCore = {flags coding = utf8 ;flags modulesize = n44 ;flags lexer = code ;flags unlexer = concat ;flags conversion = finite ;lincat Acc_ICM = {s : Str }= {s = str @ 0 } ;"Acc_ICM" ;
lincat Acc_ICM_Followed = {s : Str }= {s = str @ 0 } ;"Acc_ICM_Followed" ;
lincat Action = {s : Str }= {s = str @ 0 } ;"Action" ;
lincat Answer = {s : Str }= {s = str @ 0 } ;"Answer" ;
lincat Ask = {s : Str }= {s = str @ 0 } ;"Ask" ;
lincat DMove = {s : Str }= {s = str @ 0 } ;"DMove" ;
lincat Greet = {s : Str }= {s = str @ 0 } ;"Greet" ;
lincat ICM = {s : Str }= {s = str @ 0 } ;"ICM" ;
lincat NegAnswer = {s : Str }= {s = str @ 0 } ;"NegAnswer" ;
lincat Per_ICM = {s : Str }= {s = str @ 0 } ;"Per_ICM" ;
lincat Per_ICM_Followed = {s : Str }= {s = str @ 0 } ;"Per_ICM_Followed" ;
lincat Proposition = {s : Str }= {s = str @ 0 } ;"Proposition" ;
lincat Quit = {s : Str }= {s = str @ 0 } ;"Quit" ;
lincat Request = {s : Str }= {s = str @ 0 } ;"Request" ;
lincat S = {s : Str }= {s = str @ 0 } ;"S" ;
lincat SingleAction = {s : Str }= {s = str @ 0 } ;"SingleAction" ;
lincat SingleAsk = {s : Str }= {s = str @ 0 } ;"SingleAsk" ;
lincat Task = {s : Str }= {s = str @ 0 } ;"Task" ;
lin acc_neg : sharedCore.Acc_ICM_Followed = \ -> {s = "acc" ++ ("*" ++ "neg")} ;"acc * neg" ;
lin acc_neg_alone : sharedCore.Acc_ICM = \ -> {s = "acc" ++ ("*" ++ "neg")} ;"acc * neg" ;
lin acc_pos : sharedCore.Acc_ICM = \ -> {s = "acc" ++ ("*" ++ "pos")} ;"acc * pos" ;
lin bye_command : sharedCore.Quit = \ -> {s = "quit" } ;"quit" ;
lin greet_command : sharedCore.Greet = \ -> {s = "greet" } ;"greet" ;
lin help_command : sharedCore.SingleAction = \ -> {s = "help" } ;"help" ;
lin makeAnswer : sharedCore.Answer = \ Task @ 0, Proposition @ 1 -> {s = "answer" ++ ("(" ++ (Proposition @ 1.s ++ ")")) } ;"answer ( Proposition_1 )" ;
lin makeAnswerMove : sharedCore.DMove = \ Task @ 0, Answer @ 1 -> {s = Answer @ 1.s } ;"Answer_1" ;
lin makeAsk : sharedCore.DMove = \ SingleAsk @ 0 -> {s = "ask" ++ ("(" ++ (SingleAsk @ 0.s ++ ")")) } ;"ask ( SingleAsk_0 )" ;
lin makeGreetMove : sharedCore.DMove = \ Greet @ 0 -> {s = Greet @ 0.s } ;"Greet_0" ;
lin makeICMAcc : sharedCore.ICM = \ Acc_ICM @ 0 -> {s = Acc_ICM @ 0.s } ;"Acc_ICM_0" ;
lin makeICMMove : sharedCore.DMove = \ ICM @ 0 -> {s = "icm" ++ (":" ++ ICM @ 0.s)} ;"icm : ICM_0" ;
lin makeICMPer : sharedCore.ICM = \ Per_ICM @ 0 -> {s = Per_ICM @ 0.s } ;"Per_ICM_0" ;
lin makeNegAnswer : sharedCore.NegAnswer = \ Task @ 0, Proposition @ 1 -> {s = "answer" ++ ("(" ++ ("not" ++ ("(" ++ (Proposition @ 1.s ++ (")" ++ ")")))))} ;"answer ( not ( Proposition_1 ) )" ;
lin makeNegAnswerMove : sharedCore.DMove = \ Task @ 0, NegAnswer @ 1 -> {s = NegAnswer @ 1.s } ;"NegAnswer_1" ;
lin makeQuitMove : sharedCore.DMove = \ Quit @ 0 -> {s = Quit @ 0.s } ;"Quit_0" ;
lin makeRequest : sharedCore.Request = \ SingleAction @ 0 -> {s = "request" ++ ("(" ++ (SingleAction @ 0.s ++ ")")) } ;"request ( SingleAction_0 )" ;
lin makeRequestMove : sharedCore.DMove = \ Request @ 0 -> {s = Request @ 0.s } ;"Request_0" ;
lin makeS : sharedCore.S = \ DMove @ 0 -> {s = "[" ++ (DMove @ 0.s ++ "]")} ;"[ DMove_0 ]" ;
lin no : sharedCore.Answer = \ -> {s = "no" } ;"no" ;
lin per_int : sharedCore.Per_ICM = \ -> {s = "per" ++ ("*" ++ "int")} ;"per * int" ;
lin per_neg : sharedCore.Per_ICM = \ -> {s = "per" ++ ("*" ++ "neg")} ;"per * neg" ;
lin per_pos : sharedCore.Per_ICM_Followed = \ -> {s = "per" ++ ("*" ++ "pos")} ;"per * pos" ;
lin singleAsk : sharedCore.SingleAsk = \ Task @ 0, Ask @ 1 -> {s = "X" ++ ("^" ++ (Ask @ 1.s ++ ("(" ++ ("X" ++ ")")))) } ;"X ^ Ask_1 ( X )" ;
lin top_command : sharedCore.SingleAction = \ -> {s = "top" } ;"top" ;
lin yes : sharedCore.Answer = \ -> {s = "yes" } ;"yes" ;
}
concrete DBPro of DB = LampsPro, RoomsPro ** {flags coding = utf8 ;flags modulesize = n10 ;Lamp in LampsPro ;
Room in RoomsPro ;
bedroom in RoomsPro ;
ceilinglamp in LampsPro ;
desklamp in LampsPro ;
floorlamp in LampsPro ;
hall in RoomsPro ;
kitchen in RoomsPro ;
livingroom in RoomsPro ;
tablelamp in LampsPro ;
}
concrete LampsPro of Lamps = {flags coding = utf8 ;flags modulesize = n5 ;lincat Lamp = {s : Str }= {s = str @ 0 } ;"Lamp" ;
lin ceilinglamp : Lamps.Lamp = \ -> {s = "[ceilinglamp]" } ;"[ceilinglamp]" ;
lin desklamp : Lamps.Lamp = \ -> {s = "[desklamp]" } ;"[desklamp]" ;
lin floorlamp : Lamps.Lamp = \ -> {s = "[floorlamp]" } ;"[floorlamp]" ;
lin tablelamp : Lamps.Lamp = \ -> {s = "[tablelamp]" } ;"[tablelamp]" ;
}
concrete RoomsPro of Rooms = {flags coding = utf8 ;flags modulesize = n5 ;lincat Room = {s : Str }= {s = str @ 0 } ;"Room" ;
lin bedroom : Rooms.Room = \ -> {s = "[bedroom]" } ;"[bedroom]" ;
lin hall : Rooms.Room = \ -> {s = "[hall]" } ;"[hall]" ;
lin kitchen : Rooms.Room = \ -> {s = "[kitchen]" } ;"[kitchen]" ;
lin livingroom : Rooms.Room = \ -> {s = "[livingroom]" } ;"[livingroom]" ;
}
concrete usr_domain_lamps_svenska of usr_domain_lamps = userCoreSwe, sharedDomainSwe ** {flags coding = utf8 ;flags modulesize = n78 ;Acc_ICM in sharedCoreSwe ;
Acc_ICM_Followed in sharedCoreSwe ;
Action in sharedCoreSwe ;
Answer in sharedCoreSwe ;
AnswerList in userCoreSwe ;
Ask in sharedCoreSwe ;
CompoundedAsk in userCoreSwe ;
CompoundedRequest in userCoreSwe ;
DMove in sharedCoreSwe ;
Greet in sharedCoreSwe ;
ICM in sharedCoreSwe ;
Lamp in LampsSwe ;
NegAnswer in sharedCoreSwe ;
Per_ICM in sharedCoreSwe ;
Per_ICM_Followed in sharedCoreSwe ;
Proposition in sharedCoreSwe ;
Quit in sharedCoreSwe ;
Request in sharedCoreSwe ;
Room in RoomsSwe ;
S in sharedCoreSwe ;
SingleAction in sharedCoreSwe ;
SingleAsk in sharedCoreSwe ;
Task in sharedCoreSwe ;
acc_neg in userCoreSwe ;
acc_neg_alone in userCoreSwe ;
acc_pos in userCoreSwe ;
lin answerLampLocTurnOff : usr_domain_lamps.AnswerList = \ Lamp @ 0, Room @ 1 -> {s = Lamp @ 0.s ++ ("i" ++ Room @ 1.s)} ;"Lamp_0 i Room_1" ;
lin answerLampLocTurnOn : usr_domain_lamps.AnswerList = \ Lamp @ 0, Room @ 1 -> {s = Lamp @ 0.s ++ ("i" ++ Room @ 1.s)} ;"Lamp_0 i Room_1" ;
answerLampOff in sharedDomainSwe ;
answerLampOn in sharedDomainSwe ;
answerLocation in sharedDomainSwe ;
askStatusLamp in sharedDomainSwe ;
bedroom in RoomsSwe ;
bye_command in sharedCoreSwe ;
ceilinglamp in LampsSwe ;
desklamp in LampsSwe ;
dimmerDown in sharedDomainSwe ;
dimmerUp in sharedDomainSwe ;
floorlamp in LampsSwe ;
greet_command in sharedCoreSwe ;
hall in RoomsSwe ;
help_command in sharedCoreSwe ;
kitchen in RoomsSwe ;
livingroom in RoomsSwe ;
makeAnswer in userCoreSwe ;
makeAnswerListS in userCoreSwe ;
makeAnswerMove in userCoreSwe ;
makeAsk in userCoreSwe ;
makeAskMove in userCoreSwe ;
makeCompoundedAsk in userCoreSwe ;
makeCompoundedRequest in userCoreSwe ;
makeGreetMove in userCoreSwe ;
makeICMAcc in sharedCoreSwe ;
makeICMMove in sharedCoreSwe ;
makeICMPer in sharedCoreSwe ;
makeNegAnswer in userCoreSwe ;
makeNegAnswerMove in userCoreSwe ;
makeQuitMove in userCoreSwe ;
makeRequest in userCoreSwe ;
makeRequestMove in userCoreSwe ;
makeS in sharedCoreSwe ;
no in sharedCoreSwe ;
per_int in userCoreSwe ;
per_neg in userCoreSwe ;
questionLocation in sharedDomainSwe ;
questionWhichLamp in sharedDomainSwe ;
requestCompounded in userCoreSwe ;
requestCompoundedMulti in userCoreSwe ;
singleAsk in userCoreSwe ;
tablelamp in LampsSwe ;
top_command in sharedCoreSwe ;
turnOff in sharedDomainSwe ;
turnOffThis in sharedDomainSwe ;
turnOff_alone in sharedDomainSwe ;
turnOn in sharedDomainSwe ;
turnOnThis in sharedDomainSwe ;
turnOn_alone in sharedDomainSwe ;
yes in sharedCoreSwe ;
}
concrete userCoreSwe of userCore = sharedCoreSwe ** open GenResSwe in {flags coding = utf8 ;flags modulesize = n52 ;flags conversion = finite ;Acc_ICM in sharedCoreSwe ;
Acc_ICM_Followed in sharedCoreSwe ;
Action in sharedCoreSwe ;
Answer in sharedCoreSwe ;
lincat AnswerList = {s : Str }= {s = str @ 0 } ;"AnswerList" ;
Ask in sharedCoreSwe ;
lincat CompoundedAsk = {s : Str }= {s = str @ 0 } ;"CompoundedAsk" ;
lincat CompoundedRequest = {s : Str }= {s = str @ 0 } ;"CompoundedRequest" ;
DMove in sharedCoreSwe ;
Greet in sharedCoreSwe ;
ICM in sharedCoreSwe ;
NegAnswer in sharedCoreSwe ;
Per_ICM in sharedCoreSwe ;
Per_ICM_Followed in sharedCoreSwe ;
Proposition in sharedCoreSwe ;
Quit in sharedCoreSwe ;
Request in sharedCoreSwe ;
S in sharedCoreSwe ;
SingleAction in sharedCoreSwe ;
SingleAsk in sharedCoreSwe ;
Task in sharedCoreSwe ;
lin acc_neg : userCore.Acc_ICM_Followed = \ -> {s = "vet" ++ "inte" } ;"vet inte" ;
lin acc_neg_alone : userCore.Acc_ICM = \ -> {s = "vet" ++ "inte" } ;"vet inte" ;
lin acc_pos : userCore.Acc_ICM = \ -> {s = variants {"okej" "ok" "visst" "japp" "jaha" }} ;"okej" ;
bye_command in sharedCoreSwe ;
greet_command in sharedCoreSwe ;
help_command in sharedCoreSwe ;
lin makeAnswer : userCore.Answer = \ Task @ 0, Proposition @ 1 -> {s = Proposition @ 1.s } ;"Proposition_1" ;
lin makeAnswerListS : userCore.DMove = \ Task @ 0, AnswerList @ 1 -> {s = AnswerList @ 1.s } ;"AnswerList_1" ;
lin makeAnswerMove : userCore.DMove = \ Task @ 0, Answer @ 1 -> {s = Answer @ 1.s } ;"Answer_1" ;
lin makeAsk : userCore.DMove = \ SingleAsk @ 0 -> {s = SingleAsk @ 0.s } ;"SingleAsk_0" ;
lin makeAskMove : userCore.CompoundedAsk = \ Task @ 0, Ask @ 1, Answer @ 2 -> {s = Ask @ 1.s ++ Answer @ 2.s } ;"Ask_1 Answer_2" ;
lin makeCompoundedAsk : userCore.DMove = \ CompoundedAsk @ 0 -> {s = CompoundedAsk @ 0.s } ;"CompoundedAsk_0" ;
lin makeCompoundedRequest : userCore.DMove = \ CompoundedRequest @ 0 -> {s = variants {(variants {("jag" ++ "vill")("jag" ++ ("skulle" ++ "vilja")) }++ (CompoundedRequest @ 0.s ++ "tack")) (variants {("jag" ++ "vill")("jag" ++ ("skulle" ++ "vilja")) }++ CompoundedRequest @ 0.s)(CompoundedRequest @ 0.s ++ "tack")(CompoundedRequest @ 0.s)}} ;"(jag vill)CompoundedRequest_0 tack" ;
lin makeGreetMove : userCore.DMove = \ Greet @ 0 -> {s = Greet @ 0.s } ;"Greet_0" ;
makeICMAcc in sharedCoreSwe ;
makeICMMove in sharedCoreSwe ;
makeICMPer in sharedCoreSwe ;
lin makeNegAnswer : userCore.NegAnswer = \ Task @ 0, Proposition @ 1 -> {s = "inte" ++ Proposition @ 1.s } ;"inte Proposition_1" ;
lin makeNegAnswerMove : userCore.DMove = \ Task @ 0, NegAnswer @ 1 -> {s = NegAnswer @ 1.s } ;"NegAnswer_1" ;
lin makeQuitMove : userCore.DMove = \ Quit @ 0 -> {s = Quit @ 0.s } ;"Quit_0" ;
lin makeRequest : userCore.Request = \ SingleAction @ 0 -> {s = SingleAction @ 0.s } ;"SingleAction_0" ;
lin makeRequestMove : userCore.DMove = \ Request @ 0 -> {s = variants {(Request @ 0.s)(variants {("jag" ++ "vill")("jag" ++ ("skulle" ++ "vilja")) }++ (Request @ 0.s ++ "tack")) (variants {("jag" ++ "vill")("jag" ++ ("skulle" ++ "vilja")) }++ Request @ 0.s)(Request @ 0.s ++ "tack")}} ;"Request_0" ;
makeS in sharedCoreSwe ;
no in sharedCoreSwe ;
lin per_int : userCore.Per_ICM = \ -> {s = variants {"ursÃ¤kta" ("vad" ++ ("sa" ++ "du")) }} ;"ursäkta" ;
lin per_neg : userCore.Per_ICM = \ -> {s = variants {"va" "ursÃ¤kta" "fÃ¶rlÃ¥t" ("ursÃ¤kta" ++ ("jag" ++ ("hÃ¶rde" ++ ("inte" ++ ("vad" ++ ("du" ++ "sa")))))) }} ;"va" ;
lin requestCompounded : userCore.CompoundedRequest = \ Task @ 0, Action @ 1, Answer @ 2 -> {s = Action @ 1.s ++ Answer @ 2.s } ;"Action_1 Answer_2" ;
lin requestCompoundedMulti : userCore.CompoundedRequest = \ Task @ 0, Action @ 1, AnswerList @ 2 -> {s = Action @ 1.s ++ AnswerList @ 2.s } ;"Action_1 AnswerList_2" ;
lin singleAsk : userCore.SingleAsk = \ Task @ 0, Ask @ 1 -> {s = Ask @ 1.s } ;"Ask_1" ;
top_command in sharedCoreSwe ;
yes in sharedCoreSwe ;
}
concrete sharedDomainSwe of sharedDomain = sharedCoreSwe, DBSwe ** {flags coding = utf8 ;flags modulesize = n52 ;Acc_ICM in sharedCoreSwe ;
Acc_ICM_Followed in sharedCoreSwe ;
Action in sharedCoreSwe ;
Answer in sharedCoreSwe ;
Ask in sharedCoreSwe ;
DMove in sharedCoreSwe ;
Greet in sharedCoreSwe ;
ICM in sharedCoreSwe ;
Lamp in LampsSwe ;
NegAnswer in sharedCoreSwe ;
Per_ICM in sharedCoreSwe ;
Per_ICM_Followed in sharedCoreSwe ;
Proposition in sharedCoreSwe ;
Quit in sharedCoreSwe ;
Request in sharedCoreSwe ;
Room in RoomsSwe ;
S in sharedCoreSwe ;
SingleAction in sharedCoreSwe ;
SingleAsk in sharedCoreSwe ;
Task in sharedCoreSwe ;
lin answerLampOff : sharedDomain.Proposition = \ Lamp @ 0 -> {s = Lamp @ 0.s } ;"Lamp_0" ;
lin answerLampOn : sharedDomain.Proposition = \ Lamp @ 0 -> {s = Lamp @ 0.s } ;"Lamp_0" ;
lin answerLocation : sharedDomain.Proposition = \ Room @ 0 -> {s = Room @ 0.s } ;"Room_0" ;
lin askStatusLamp : sharedDomain.SingleAsk = \ -> {s = "vilka" ++ ("lampor" ++ ("Ã¤r" ++ "tÃ¤nda")) } ;"vilka lampor är tända" ;
bedroom in RoomsSwe ;
bye_command in sharedCoreSwe ;
ceilinglamp in LampsSwe ;
desklamp in LampsSwe ;
lin dimmerDown : sharedDomain.SingleAction = \ -> {s = "dimma" ++ "ner" } ;"dimma ner" ;
lin dimmerUp : sharedDomain.SingleAction = \ -> {s = "dimma" ++ "upp" } ;"dimma upp" ;
floorlamp in LampsSwe ;
greet_command in sharedCoreSwe ;
hall in RoomsSwe ;
help_command in sharedCoreSwe ;
kitchen in RoomsSwe ;
livingroom in RoomsSwe ;
makeICMAcc in sharedCoreSwe ;
makeICMMove in sharedCoreSwe ;
makeICMPer in sharedCoreSwe ;
makeS in sharedCoreSwe ;
no in sharedCoreSwe ;
lin questionLocation : sharedDomain.Proposition = \ Room @ 0 -> {s = Room @ 0.s } ;"Room_0" ;
lin questionWhichLamp : sharedDomain.Proposition = \ Lamp @ 0 -> {s = Lamp @ 0.s } ;"Lamp_0" ;
tablelamp in LampsSwe ;
top_command in sharedCoreSwe ;
lin turnOff : sharedDomain.Action = \ -> {s = "slÃ¤cka" } ;"släcka" ;
lin turnOffThis : sharedDomain.SingleAction = \ -> {s = "slÃ¤cka" } ;"släcka" ;
lin turnOff_alone : sharedDomain.SingleAction = \ -> {s = "slÃ¤cka" ++ "lampan" } ;"släcka lampan" ;
lin turnOn : sharedDomain.Action = \ -> {s = "tÃ¤nda" } ;"tända" ;
lin turnOnThis : sharedDomain.SingleAction = \ -> {s = "tÃ¤nda" } ;"tända" ;
lin turnOn_alone : sharedDomain.SingleAction = \ -> {s = "tÃ¤nda" ++ "lampan" } ;"tända lampan" ;
yes in sharedCoreSwe ;
}
concrete sharedCoreSwe of sharedCore = open GenResSwe in {flags coding = utf8 ;flags modulesize = n28 ;flags conversion = finite ;lincat Acc_ICM = {s : Str }= {s = str @ 0 } ;"Acc_ICM" ;
lincat Acc_ICM_Followed = {s : Str }= {s = str @ 0 } ;"Acc_ICM_Followed" ;
lincat Action = {s : Str }= {s = str @ 0 } ;"Action" ;
lincat Answer = {s : Str }= {s = str @ 0 } ;"Answer" ;
lincat Ask = {s : Str }= {s = str @ 0 } ;"Ask" ;
lincat DMove = {s : Str }= {s = str @ 0 } ;"DMove" ;
lincat Greet = {s : Str }= {s = str @ 0 } ;"Greet" ;
lincat ICM = {s : Str }= {s = str @ 0 } ;"ICM" ;
lincat NegAnswer = {s : Str }= {s = str @ 0 } ;"NegAnswer" ;
lincat Per_ICM = {s : Str }= {s = str @ 0 } ;"Per_ICM" ;
lincat Per_ICM_Followed = {s : Str }= {s = str @ 0 } ;"Per_ICM_Followed" ;
lincat Proposition = {s : Str }= {s = str @ 0 } ;"Proposition" ;
lincat Quit = {s : Str }= {s = str @ 0 } ;"Quit" ;
lincat Request = {s : Str }= {s = str @ 0 } ;"Request" ;
lincat S = {s : Str }= {s = str @ 0 } ;"S" ;
lincat SingleAction = {s : Str }= {s = str @ 0 } ;"SingleAction" ;
lincat SingleAsk = {s : Str }= {s = str @ 0 } ;"SingleAsk" ;
lincat Task = {s : Str }= {s = str @ 0 } ;"Task" ;
lin bye_command : sharedCore.Quit = \ -> {s = variants {"hejdÃ¥" "sluta" "avbryt" }} ;"hejdå" ;
lin greet_command : sharedCore.Greet = \ -> {s = variants {"hej" "tjena" "hallÃ¥" }} ;"hej" ;
lin help_command : sharedCore.SingleAction = \ -> {s = variants {"fÃ¥" "ha" }++ "hjÃ¤lp" } ;"få hjälp" ;
lin makeICMAcc : sharedCore.ICM = \ Acc_ICM @ 0 -> {s = Acc_ICM @ 0.s } ;"Acc_ICM_0" ;
lin makeICMMove : sharedCore.DMove = \ ICM @ 0 -> {s = ICM @ 0.s } ;"ICM_0" ;
lin makeICMPer : sharedCore.ICM = \ Per_ICM @ 0 -> {s = Per_ICM @ 0.s } ;"Per_ICM_0" ;
lin makeS : sharedCore.S = \ DMove @ 0 -> {s = DMove @ 0.s } ;"DMove_0" ;
lin no : sharedCore.Answer = \ -> {s = variants {"nej" "nepp" }} ;"nej" ;
lin top_command : sharedCore.SingleAction = \ -> {s = variants {("glÃ¶mma" ++ "allt")("bÃ¶rja" ++ "om")}} ;"glömma allt" ;
lin yes : sharedCore.Answer = \ -> {s = variants {"ja" "japp" "jajamen" }} ;"ja" ;
}
resource GenResSwe = {flags coding = utf8 ;flags modulesize = n1 ;param Form = Ques | Req | ReqNeg ;
}
concrete DBSwe of DB = LampsSwe, RoomsSwe ** {flags coding = utf8 ;flags modulesize = n10 ;Lamp in LampsSwe ;
Room in RoomsSwe ;
bedroom in RoomsSwe ;
ceilinglamp in LampsSwe ;
desklamp in LampsSwe ;
floorlamp in LampsSwe ;
hall in RoomsSwe ;
kitchen in RoomsSwe ;
livingroom in RoomsSwe ;
tablelamp in LampsSwe ;
}
concrete LampsSwe of Lamps = {flags coding = utf8 ;flags modulesize = n5 ;lincat Lamp = {s : Str }= {s = str @ 0 } ;"Lamp" ;
lin ceilinglamp : Lamps.Lamp = \ -> {s = variants {"taklampan" ("en" ++ "taklampa")}} ;"taklampan" ;
lin desklamp : Lamps.Lamp = \ -> {s = variants {"skrivbordslampan" ("en" ++ "skrivbordslampa")}} ;"skrivbordslampan" ;
lin floorlamp : Lamps.Lamp = \ -> {s = variants {"golvlampan" ("en" ++ "golvlampa")}} ;"golvlampan" ;
lin tablelamp : Lamps.Lamp = \ -> {s = variants {"bordslampan" ("en" ++ "bordslampa")}} ;"bordslampan" ;
}
concrete RoomsSwe of Rooms = {flags coding = utf8 ;flags modulesize = n5 ;lincat Room = {s : Str }= {s = str @ 0 } ;"Room" ;
lin bedroom : Rooms.Room = \ -> {s = "sovrumet" } ;"sovrumet" ;
lin hall : Rooms.Room = \ -> {s = "hallen" } ;"hallen" ;
lin kitchen : Rooms.Room = \ -> {s = "kÃ¶ket" } ;"köket" ;
lin livingroom : Rooms.Room = \ -> {s = "vardagsrumet" } ;"vardagsrumet" ;
}
concrete usr_domain_lamps_english of usr_domain_lamps = userCoreEng, sharedDomainEng ** {flags coding = utf8 ;flags modulesize = n78 ;Acc_ICM in sharedCoreEng ;
Acc_ICM_Followed in sharedCoreEng ;
Action in sharedCoreEng ;
Answer in sharedCoreEng ;
AnswerList in userCoreEng ;
Ask in sharedCoreEng ;
CompoundedAsk in userCoreEng ;
CompoundedRequest in userCoreEng ;
DMove in sharedCoreEng ;
Greet in sharedCoreEng ;
ICM in sharedCoreEng ;
Lamp in LampsEng ;
NegAnswer in sharedCoreEng ;
Per_ICM in sharedCoreEng ;
Per_ICM_Followed in sharedCoreEng ;
Proposition in sharedCoreEng ;
Quit in sharedCoreEng ;
Request in sharedCoreEng ;
Room in RoomsEng ;
S in sharedCoreEng ;
SingleAction in sharedCoreEng ;
SingleAsk in sharedCoreEng ;
Task in sharedCoreEng ;
acc_neg in userCoreEng ;
acc_neg_alone in userCoreEng ;
acc_pos in userCoreEng ;
lin answerLampLocTurnOff : usr_domain_lamps.AnswerList = \ Lamp @ 0, Room @ 1 -> {s = Lamp @ 0.s ++ ("in" ++ Room @ 1.s)} ;"Lamp_0 in Room_1" ;
lin answerLampLocTurnOn : usr_domain_lamps.AnswerList = \ Lamp @ 0, Room @ 1 -> {s = Lamp @ 0.s ++ ("in" ++ Room @ 1.s)} ;"Lamp_0 in Room_1" ;
answerLampOff in sharedDomainEng ;
answerLampOn in sharedDomainEng ;
answerLocation in sharedDomainEng ;
askStatusLamp in sharedDomainEng ;
bedroom in RoomsEng ;
bye_command in sharedCoreEng ;
ceilinglamp in LampsEng ;
desklamp in LampsEng ;
dimmerDown in sharedDomainEng ;
dimmerUp in sharedDomainEng ;
floorlamp in LampsEng ;
greet_command in sharedCoreEng ;
hall in RoomsEng ;
help_command in sharedCoreEng ;
kitchen in RoomsEng ;
livingroom in RoomsEng ;
makeAnswer in userCoreEng ;
makeAnswerListS in userCoreEng ;
makeAnswerMove in userCoreEng ;
makeAsk in userCoreEng ;
makeAskMove in userCoreEng ;
makeCompoundedAsk in userCoreEng ;
makeCompoundedRequest in userCoreEng ;
makeGreetMove in userCoreEng ;
makeICMAcc in sharedCoreEng ;
makeICMMove in sharedCoreEng ;
makeICMPer in sharedCoreEng ;
makeNegAnswer in userCoreEng ;
makeNegAnswerMove in userCoreEng ;
makeQuitMove in userCoreEng ;
makeRequest in userCoreEng ;
makeRequestMove in userCoreEng ;
makeS in sharedCoreEng ;
no in sharedCoreEng ;
per_int in userCoreEng ;
per_neg in userCoreEng ;
questionLocation in sharedDomainEng ;
questionWhichLamp in sharedDomainEng ;
requestCompounded in userCoreEng ;
requestCompoundedMulti in userCoreEng ;
singleAsk in userCoreEng ;
tablelamp in LampsEng ;
top_command in sharedCoreEng ;
turnOff in sharedDomainEng ;
turnOffThis in sharedDomainEng ;
turnOff_alone in sharedDomainEng ;
turnOn in sharedDomainEng ;
turnOnThis in sharedDomainEng ;
turnOn_alone in sharedDomainEng ;
yes in sharedCoreEng ;
}
abstract usr_domain_lamps = userCore, sharedDomain ** {flags coding = utf8 ;flags modulesize = n85 ;Acc_ICM in sharedCore ;
Acc_ICM_Followed in sharedCore ;
Action in sharedCore ;
Answer in sharedCore ;
AnswerList in userCore ;
Ask in sharedCore ;
CompoundedAsk in userCore ;
CompoundedRequest in userCore ;
DMove in sharedCore ;
Greet in sharedCore ;
ICM in sharedCore ;
Lamp in Lamps ;
NegAnswer in sharedCore ;
Per_ICM in sharedCore ;
Per_ICM_Followed in sharedCore ;
Proposition in sharedCore ;
Quit in sharedCore ;
Request in sharedCore ;
Room in Rooms ;
S in sharedCore ;
SingleAction in sharedCore ;
SingleAsk in sharedCore ;
Task in sharedCore ;
acc_neg in sharedCore ;
acc_neg_alone in sharedCore ;
acc_pos in sharedCore ;
fun answerLampLocTurnOff : (h_ : Lamps.Lamp)-> (h_ : Rooms.Room)-> userCore.AnswerList sharedDomain.offTask = {} ;
fun answerLampLocTurnOn : (h_ : Lamps.Lamp)-> (h_ : Rooms.Room)-> userCore.AnswerList sharedDomain.onTask = {} ;
answerLampOff in sharedDomain ;
answerLampOn in sharedDomain ;
answerLocation in sharedDomain ;
askStatusLamp in sharedDomain ;
bedroom in Rooms ;
bye_command in sharedCore ;
ceilinglamp in Lamps ;
desklamp in Lamps ;
dimmerDown in sharedDomain ;
dimmerUp in sharedDomain ;
floorlamp in Lamps ;
greet_command in sharedCore ;
hall in Rooms ;
help_command in sharedCore ;
kitchen in Rooms ;
lampQuestion in sharedDomain ;
livingroom in Rooms ;
locQuestion in sharedDomain ;
locateTask in sharedDomain ;
makeAnswer in sharedCore ;
makeAnswerListS in userCore ;
makeAnswerMove in sharedCore ;
makeAsk in sharedCore ;
makeAskMove in userCore ;
makeCompoundedAsk in userCore ;
makeCompoundedRequest in userCore ;
makeGreetMove in sharedCore ;
makeICMAcc in sharedCore ;
makeICMMove in sharedCore ;
makeICMPer in sharedCore ;
makeNegAnswer in sharedCore ;
makeNegAnswerMove in sharedCore ;
makeQuitMove in sharedCore ;
makeRequest in sharedCore ;
makeRequestMove in sharedCore ;
makeS in sharedCore ;
no in sharedCore ;
offTask in sharedDomain ;
onTask in sharedDomain ;
per_int in sharedCore ;
per_neg in sharedCore ;
per_pos in sharedCore ;
questionLocation in sharedDomain ;
questionWhichLamp in sharedDomain ;
requestCompounded in userCore ;
requestCompoundedMulti in userCore ;
shortAnswer in sharedCore ;
singleAsk in sharedCore ;
tablelamp in Lamps ;
top_command in sharedCore ;
turnOff in sharedDomain ;
turnOffThis in sharedDomain ;
turnOff_alone in sharedDomain ;
turnOn in sharedDomain ;
turnOnThis in sharedDomain ;
turnOn_alone in sharedDomain ;
yes in sharedCore ;
}
concrete userCoreEng of userCore = sharedCoreEng ** open GenResEng in {flags coding = utf8 ;flags modulesize = n52 ;flags conversion = finite ;Acc_ICM in sharedCoreEng ;
Acc_ICM_Followed in sharedCoreEng ;
Action in sharedCoreEng ;
Answer in sharedCoreEng ;
lincat AnswerList = {s : Str }= {s = str @ 0 } ;"AnswerList" ;
Ask in sharedCoreEng ;
lincat CompoundedAsk = {s : Str }= {s = str @ 0 } ;"CompoundedAsk" ;
lincat CompoundedRequest = {s : Str }= {s = str @ 0 } ;"CompoundedRequest" ;
DMove in sharedCoreEng ;
Greet in sharedCoreEng ;
ICM in sharedCoreEng ;
NegAnswer in sharedCoreEng ;
Per_ICM in sharedCoreEng ;
Per_ICM_Followed in sharedCoreEng ;
Proposition in sharedCoreEng ;
Quit in sharedCoreEng ;
Request in sharedCoreEng ;
S in sharedCoreEng ;
SingleAction in sharedCoreEng ;
SingleAsk in sharedCoreEng ;
Task in sharedCoreEng ;
lin acc_neg : userCore.Acc_ICM_Followed = \ -> {s = "i" ++ ("do" ++ ("not" ++ "know")) } ;"i do not know" ;
lin acc_neg_alone : userCore.Acc_ICM = \ -> {s = "i" ++ ("do" ++ ("not" ++ "know")) } ;"i do not know" ;
lin acc_pos : userCore.Acc_ICM = \ -> {s = variants {"okay" "ok" "sure" "yup" "right" }} ;"okay" ;
bye_command in sharedCoreEng ;
greet_command in sharedCoreEng ;
help_command in sharedCoreEng ;
lin makeAnswer : userCore.Answer = \ Task @ 0, Proposition @ 1 -> {s = Proposition @ 1.s } ;"Proposition_1" ;
lin makeAnswerListS : userCore.DMove = \ Task @ 0, AnswerList @ 1 -> {s = AnswerList @ 1.s } ;"AnswerList_1" ;
lin makeAnswerMove : userCore.DMove = \ Task @ 0, Answer @ 1 -> {s = Answer @ 1.s } ;"Answer_1" ;
lin makeAsk : userCore.DMove = \ SingleAsk @ 0 -> {s = SingleAsk @ 0.s } ;"SingleAsk_0" ;
lin makeAskMove : userCore.CompoundedAsk = \ Task @ 0, Ask @ 1, Answer @ 2 -> {s = Ask @ 1.s ++ Answer @ 2.s } ;"Ask_1 Answer_2" ;
lin makeCompoundedAsk : userCore.DMove = \ CompoundedAsk @ 0 -> {s = CompoundedAsk @ 0.s } ;"CompoundedAsk_0" ;
lin makeCompoundedRequest : userCore.DMove = \ CompoundedRequest @ 0 -> {s = variants {(variants {("i" ++ ("want" ++ "to")) ("i" ++ ("would" ++ ("like" ++ "to")))}++ (CompoundedRequest @ 0.s ++ "please")) (variants {("i" ++ ("want" ++ "to")) ("i" ++ ("would" ++ ("like" ++ "to")))}++ CompoundedRequest @ 0.s)(CompoundedRequest @ 0.s ++ "please")(CompoundedRequest @ 0.s)}} ;"(i want to)CompoundedRequest_0 please" ;
lin makeGreetMove : userCore.DMove = \ Greet @ 0 -> {s = Greet @ 0.s } ;"Greet_0" ;
makeICMAcc in sharedCoreEng ;
makeICMMove in sharedCoreEng ;
makeICMPer in sharedCoreEng ;
lin makeNegAnswer : userCore.NegAnswer = \ Task @ 0, Proposition @ 1 -> {s = "not" ++ Proposition @ 1.s } ;"not Proposition_1" ;
lin makeNegAnswerMove : userCore.DMove = \ Task @ 0, NegAnswer @ 1 -> {s = NegAnswer @ 1.s } ;"NegAnswer_1" ;
lin makeQuitMove : userCore.DMove = \ Quit @ 0 -> {s = Quit @ 0.s } ;"Quit_0" ;
lin makeRequest : userCore.Request = \ SingleAction @ 0 -> {s = SingleAction @ 0.s } ;"SingleAction_0" ;
lin makeRequestMove : userCore.DMove = \ Request @ 0 -> {s = variants {(Request @ 0.s)(variants {("i" ++ ("want" ++ "to")) ("i" ++ ("would" ++ ("like" ++ "to")))}++ (Request @ 0.s ++ "please")) (variants {("i" ++ ("want" ++ "to")) ("i" ++ ("would" ++ ("like" ++ "to")))}++ Request @ 0.s)(Request @ 0.s ++ "please")}} ;"Request_0" ;
makeS in sharedCoreEng ;
no in sharedCoreEng ;
lin per_int : userCore.Per_ICM = \ -> {s = variants {"pardon" ("what" ++ ("did" ++ ("you" ++ "say")))}} ;"pardon" ;
lin per_neg : userCore.Per_ICM = \ -> {s = variants {"what" "pardon" ("pardon" ++ ("i" ++ ("did" ++ ("not" ++ ("hear" ++ ("what" ++ ("you" ++ "said")))))))}} ;"what" ;
lin requestCompounded : userCore.CompoundedRequest = \ Task @ 0, Action @ 1, Answer @ 2 -> {s = Action @ 1.s ++ Answer @ 2.s } ;"Action_1 Answer_2" ;
lin requestCompoundedMulti : userCore.CompoundedRequest = \ Task @ 0, Action @ 1, AnswerList @ 2 -> {s = Action @ 1.s ++ AnswerList @ 2.s } ;"Action_1 AnswerList_2" ;
lin singleAsk : userCore.SingleAsk = \ Task @ 0, Ask @ 1 -> {s = Ask @ 1.s } ;"Ask_1" ;
top_command in sharedCoreEng ;
yes in sharedCoreEng ;
}
abstract userCore = sharedCore ** {flags coding = utf8 ;flags modulesize = n54 ;Acc_ICM in sharedCore ;
Acc_ICM_Followed in sharedCore ;
Action in sharedCore ;
Answer in sharedCore ;
cat AnswerList [h_ : sharedCore.Task]= ;
Ask in sharedCore ;
cat CompoundedAsk [] = ;
cat CompoundedRequest [] = ;
DMove in sharedCore ;
Greet in sharedCore ;
ICM in sharedCore ;
NegAnswer in sharedCore ;
Per_ICM in sharedCore ;
Per_ICM_Followed in sharedCore ;
Proposition in sharedCore ;
Quit in sharedCore ;
Request in sharedCore ;
S in sharedCore ;
SingleAction in sharedCore ;
SingleAsk in sharedCore ;
Task in sharedCore ;
acc_neg in sharedCore ;
acc_neg_alone in sharedCore ;
acc_pos in sharedCore ;
bye_command in sharedCore ;
greet_command in sharedCore ;
help_command in sharedCore ;
makeAnswer in sharedCore ;
fun makeAnswerListS : (t : sharedCore.Task)-> (h_ : userCore.AnswerList $t)-> sharedCore.DMove = {} ;
makeAnswerMove in sharedCore ;
makeAsk in sharedCore ;
fun makeAskMove : (t : sharedCore.Task)-> (h_ : sharedCore.Ask $t)-> (h_ : sharedCore.Answer $t)-> userCore.CompoundedAsk = {} ;
fun makeCompoundedAsk : (h_ : userCore.CompoundedAsk)-> sharedCore.DMove = {} ;
fun makeCompoundedRequest : (h_ : userCore.CompoundedRequest)-> sharedCore.DMove = {} ;
makeGreetMove in sharedCore ;
makeICMAcc in sharedCore ;
makeICMMove in sharedCore ;
makeICMPer in sharedCore ;
makeNegAnswer in sharedCore ;
makeNegAnswerMove in sharedCore ;
makeQuitMove in sharedCore ;
makeRequest in sharedCore ;
makeRequestMove in sharedCore ;
makeS in sharedCore ;
no in sharedCore ;
per_int in sharedCore ;
per_neg in sharedCore ;
per_pos in sharedCore ;
fun requestCompounded : (t : sharedCore.Task)-> (h_ : sharedCore.Action $t)-> (h_ : sharedCore.Answer $t)-> userCore.CompoundedRequest = {} ;
fun requestCompoundedMulti : (t : sharedCore.Task)-> (h_ : sharedCore.Action $t)-> (h_ : userCore.AnswerList $t)-> userCore.CompoundedRequest = {} ;
shortAnswer in sharedCore ;
singleAsk in sharedCore ;
top_command in sharedCore ;
yes in sharedCore ;
}
concrete sharedDomainEng of sharedDomain = sharedCoreEng, DBEng ** open SpecResEng in {flags coding = utf8 ;flags modulesize = n52 ;Acc_ICM in sharedCoreEng ;
Acc_ICM_Followed in sharedCoreEng ;
Action in sharedCoreEng ;
Answer in sharedCoreEng ;
Ask in sharedCoreEng ;
DMove in sharedCoreEng ;
Greet in sharedCoreEng ;
ICM in sharedCoreEng ;
Lamp in LampsEng ;
NegAnswer in sharedCoreEng ;
Per_ICM in sharedCoreEng ;
Per_ICM_Followed in sharedCoreEng ;
Proposition in sharedCoreEng ;
Quit in sharedCoreEng ;
Request in sharedCoreEng ;
Room in RoomsEng ;
S in sharedCoreEng ;
SingleAction in sharedCoreEng ;
SingleAsk in sharedCoreEng ;
Task in sharedCoreEng ;
lin answerLampOff : sharedDomain.Proposition = \ Lamp @ 0 -> {s = Lamp @ 0.s } ;"Lamp_0" ;
lin answerLampOn : sharedDomain.Proposition = \ Lamp @ 0 -> {s = Lamp @ 0.s } ;"Lamp_0" ;
lin answerLocation : sharedDomain.Proposition = \ Room @ 0 -> {s = Room @ 0.s } ;"Room_0" ;
lin askStatusLamp : sharedDomain.SingleAsk = \ -> {s = "what" ++ ("lights" ++ ("are" ++ "on")) } ;"what lights are on" ;
bedroom in RoomsEng ;
bye_command in sharedCoreEng ;
ceilinglamp in LampsEng ;
desklamp in LampsEng ;
lin dimmerDown : sharedDomain.SingleAction = \ -> {s = "dim" ++ "down" } ;"dim down" ;
lin dimmerUp : sharedDomain.SingleAction = \ -> {s = "dim" ++ "up" } ;"dim up" ;
floorlamp in LampsEng ;
greet_command in sharedCoreEng ;
hall in RoomsEng ;
help_command in sharedCoreEng ;
kitchen in RoomsEng ;
livingroom in RoomsEng ;
makeICMAcc in sharedCoreEng ;
makeICMMove in sharedCoreEng ;
makeICMPer in sharedCoreEng ;
makeS in sharedCoreEng ;
no in sharedCoreEng ;
lin questionLocation : sharedDomain.Proposition = \ Room @ 0 -> {s = Room @ 0.s } ;"Room_0" ;
lin questionWhichLamp : sharedDomain.Proposition = \ Lamp @ 0 -> {s = Lamp @ 0.s } ;"Lamp_0" ;
tablelamp in LampsEng ;
top_command in sharedCoreEng ;
lin turnOff : sharedDomain.Action = \ -> {s = "turn" ++ "off" } ;"turn off" ;
lin turnOffThis : sharedDomain.SingleAction = \ -> {s = "turn" ++ "off" } ;"turn off" ;
lin turnOff_alone : sharedDomain.SingleAction = \ -> {s = "turn" ++ ("off" ++ ("the" ++ "light")) } ;"turn off the light" ;
lin turnOn : sharedDomain.Action = \ -> {s = "turn" ++ "on" } ;"turn on" ;
lin turnOnThis : sharedDomain.SingleAction = \ -> {s = "turn" ++ "on" } ;"turn on" ;
lin turnOn_alone : sharedDomain.SingleAction = \ -> {s = "turn" ++ ("on" ++ ("the" ++ "light")) } ;"turn on the light" ;
yes in sharedCoreEng ;
}
abstract sharedDomain = sharedCore, DB ** {flags coding = utf8 ;flags modulesize = n74 ;Acc_ICM in sharedCore ;
Acc_ICM_Followed in sharedCore ;
Action in sharedCore ;
Answer in sharedCore ;
Ask in sharedCore ;
DMove in sharedCore ;
Greet in sharedCore ;
ICM in sharedCore ;
Lamp in Lamps ;
NegAnswer in sharedCore ;
Per_ICM in sharedCore ;
Per_ICM_Followed in sharedCore ;
Proposition in sharedCore ;
Quit in sharedCore ;
Request in sharedCore ;
Room in Rooms ;
S in sharedCore ;
SingleAction in sharedCore ;
SingleAsk in sharedCore ;
Task in sharedCore ;
acc_neg in sharedCore ;
acc_neg_alone in sharedCore ;
acc_pos in sharedCore ;
fun answerLampOff : (h_ : Lamps.Lamp)-> sharedCore.Proposition sharedDomain.offTask = {} ;
fun answerLampOn : (h_ : Lamps.Lamp)-> sharedCore.Proposition sharedDomain.onTask = {} ;
fun answerLocation : (h_ : Rooms.Room)-> sharedCore.Proposition sharedDomain.locateTask = {} ;
fun askStatusLamp : sharedCore.SingleAsk = {} ;
bedroom in Rooms ;
bye_command in sharedCore ;
ceilinglamp in Lamps ;
desklamp in Lamps ;
fun dimmerDown : sharedCore.SingleAction = {} ;
fun dimmerUp : sharedCore.SingleAction = {} ;
floorlamp in Lamps ;
greet_command in sharedCore ;
hall in Rooms ;
help_command in sharedCore ;
kitchen in Rooms ;
fun lampQuestion : sharedCore.Task = {} ;
livingroom in Rooms ;
fun locQuestion : sharedCore.Task = {} ;
fun locateTask : sharedCore.Task = {} ;
makeAnswer in sharedCore ;
makeAnswerMove in sharedCore ;
makeAsk in sharedCore ;
makeGreetMove in sharedCore ;
makeICMAcc in sharedCore ;
makeICMMove in sharedCore ;
makeICMPer in sharedCore ;
makeNegAnswer in sharedCore ;
makeNegAnswerMove in sharedCore ;
makeQuitMove in sharedCore ;
makeRequest in sharedCore ;
makeRequestMove in sharedCore ;
makeS in sharedCore ;
no in sharedCore ;
fun offTask : sharedCore.Task = {} ;
fun onTask : sharedCore.Task = {} ;
per_int in sharedCore ;
per_neg in sharedCore ;
per_pos in sharedCore ;
fun questionLocation : (h_ : Rooms.Room)-> sharedCore.Proposition sharedDomain.locQuestion = {} ;
fun questionWhichLamp : (h_ : Lamps.Lamp)-> sharedCore.Proposition sharedDomain.lampQuestion = {} ;
shortAnswer in sharedCore ;
singleAsk in sharedCore ;
tablelamp in Lamps ;
top_command in sharedCore ;
fun turnOff : sharedCore.Action sharedDomain.offTask = {} ;
fun turnOffThis : sharedCore.SingleAction = {} ;
fun turnOff_alone : sharedCore.SingleAction = {} ;
fun turnOn : sharedCore.Action sharedDomain.onTask = {} ;
fun turnOnThis : sharedCore.SingleAction = {} ;
fun turnOn_alone : sharedCore.SingleAction = {} ;
yes in sharedCore ;
}
concrete sharedCoreEng of sharedCore = open GenResEng in {flags coding = utf8 ;flags modulesize = n28 ;flags conversion = finite ;lincat Acc_ICM = {s : Str }= {s = str @ 0 } ;"Acc_ICM" ;
lincat Acc_ICM_Followed = {s : Str }= {s = str @ 0 } ;"Acc_ICM_Followed" ;
lincat Action = {s : Str }= {s = str @ 0 } ;"Action" ;
lincat Answer = {s : Str }= {s = str @ 0 } ;"Answer" ;
lincat Ask = {s : Str }= {s = str @ 0 } ;"Ask" ;
lincat DMove = {s : Str }= {s = str @ 0 } ;"DMove" ;
lincat Greet = {s : Str }= {s = str @ 0 } ;"Greet" ;
lincat ICM = {s : Str }= {s = str @ 0 } ;"ICM" ;
lincat NegAnswer = {s : Str }= {s = str @ 0 } ;"NegAnswer" ;
lincat Per_ICM = {s : Str }= {s = str @ 0 } ;"Per_ICM" ;
lincat Per_ICM_Followed = {s : Str }= {s = str @ 0 } ;"Per_ICM_Followed" ;
lincat Proposition = {s : Str }= {s = str @ 0 } ;"Proposition" ;
lincat Quit = {s : Str }= {s = str @ 0 } ;"Quit" ;
lincat Request = {s : Str }= {s = str @ 0 } ;"Request" ;
lincat S = {s : Str }= {s = str @ 0 } ;"S" ;
lincat SingleAction = {s : Str }= {s = str @ 0 } ;"SingleAction" ;
lincat SingleAsk = {s : Str }= {s = str @ 0 } ;"SingleAsk" ;
lincat Task = {s : Str }= {s = str @ 0 } ;"Task" ;
lin bye_command : sharedCore.Quit = \ -> {s = variants {"goodbye" "bye" "end" }} ;"goodbye" ;
lin greet_command : sharedCore.Greet = \ -> {s = variants {"hello" "hi" "yo" }} ;"hello" ;
lin help_command : sharedCore.SingleAction = \ -> {s = variants {"get" [] }++ "help" } ;"get help" ;
lin makeICMAcc : sharedCore.ICM = \ Acc_ICM @ 0 -> {s = Acc_ICM @ 0.s } ;"Acc_ICM_0" ;
lin makeICMMove : sharedCore.DMove = \ ICM @ 0 -> {s = ICM @ 0.s } ;"ICM_0" ;
lin makeICMPer : sharedCore.ICM = \ Per_ICM @ 0 -> {s = Per_ICM @ 0.s } ;"Per_ICM_0" ;
lin makeS : sharedCore.S = \ DMove @ 0 -> {s = DMove @ 0.s } ;"DMove_0" ;
lin no : sharedCore.Answer = \ -> {s = variants {"no" "nope" }} ;"no" ;
lin top_command : sharedCore.SingleAction = \ -> {s = variants {"top" ("forget" ++ "everything")("start" ++ "over")}} ;"top" ;
lin yes : sharedCore.Answer = \ -> {s = variants {"yes" "yup" "yeppers" }} ;"yes" ;
}
abstract sharedCore = {flags coding = utf8 ;flags modulesize = n45 ;cat Acc_ICM [] = ;
cat Acc_ICM_Followed [] = ;
cat Action [h_ : sharedCore.Task]= ;
cat Answer [h_ : sharedCore.Task]= ;
cat Ask [h_ : sharedCore.Task]= ;
cat DMove [] = ;
cat Greet [] = ;
cat ICM [] = ;
cat NegAnswer [h_ : sharedCore.Task]= ;
cat Per_ICM [] = ;
cat Per_ICM_Followed [] = ;
cat Proposition [h_ : sharedCore.Task]= ;
cat Quit [] = ;
cat Request [] = ;
cat S [] = ;
cat SingleAction [] = ;
cat SingleAsk [] = ;
cat Task [] = ;
fun acc_neg : sharedCore.Acc_ICM_Followed = {} ;
fun acc_neg_alone : sharedCore.Acc_ICM = {} ;
fun acc_pos : sharedCore.Acc_ICM = {} ;
fun bye_command : sharedCore.Quit = {} ;
fun greet_command : sharedCore.Greet = {} ;
fun help_command : sharedCore.SingleAction = {} ;
fun makeAnswer : (t : sharedCore.Task)-> (h_ : sharedCore.Proposition $t)-> sharedCore.Answer $t = {} ;
fun makeAnswerMove : (t : sharedCore.Task)-> (h_ : sharedCore.Answer $t)-> sharedCore.DMove = {} ;
fun makeAsk : (h_ : sharedCore.SingleAsk)-> sharedCore.DMove = {} ;
fun makeGreetMove : (h_ : sharedCore.Greet)-> sharedCore.DMove = {} ;
fun makeICMAcc : (h_ : sharedCore.Acc_ICM)-> sharedCore.ICM = {} ;
fun makeICMMove : (h_ : sharedCore.ICM)-> sharedCore.DMove = {} ;
fun makeICMPer : (h_ : sharedCore.Per_ICM)-> sharedCore.ICM = {} ;
fun makeNegAnswer : (t : sharedCore.Task)-> (h_ : sharedCore.Proposition $t)-> sharedCore.NegAnswer $t = {} ;
fun makeNegAnswerMove : (t : sharedCore.Task)-> (h_ : sharedCore.NegAnswer $t)-> sharedCore.DMove = {} ;
fun makeQuitMove : (h_ : sharedCore.Quit)-> sharedCore.DMove = {} ;
fun makeRequest : (h_ : sharedCore.SingleAction)-> sharedCore.Request = {} ;
fun makeRequestMove : (h_ : sharedCore.Request)-> sharedCore.DMove = {} ;
fun makeS : (h_ : sharedCore.DMove)-> sharedCore.S = {} ;
fun no : sharedCore.Answer sharedCore.shortAnswer = {} ;
fun per_int : sharedCore.Per_ICM = {} ;
fun per_neg : sharedCore.Per_ICM = {} ;
fun per_pos : sharedCore.Per_ICM_Followed = {} ;
fun shortAnswer : sharedCore.Task = {} ;
fun singleAsk : (t : sharedCore.Task)-> (h_ : sharedCore.Ask $t)-> sharedCore.SingleAsk = {} ;
fun top_command : sharedCore.SingleAction = {} ;
fun yes : sharedCore.Answer sharedCore.shortAnswer = {} ;
}
resource GenResEng = {flags coding = utf8 ;flags modulesize = n1 ;param Form = Ques | Req | ReqNeg ;
}
concrete DBEng of DB = LampsEng, RoomsEng ** {flags coding = utf8 ;flags modulesize = n10 ;Lamp in LampsEng ;
Room in RoomsEng ;
bedroom in RoomsEng ;
ceilinglamp in LampsEng ;
desklamp in LampsEng ;
floorlamp in LampsEng ;
hall in RoomsEng ;
kitchen in RoomsEng ;
livingroom in RoomsEng ;
tablelamp in LampsEng ;
}
abstract DB = Lamps, Rooms ** {flags coding = utf8 ;flags modulesize = n10 ;Lamp in Lamps ;
Room in Rooms ;
bedroom in Rooms ;
ceilinglamp in Lamps ;
desklamp in Lamps ;
floorlamp in Lamps ;
hall in Rooms ;
kitchen in Rooms ;
livingroom in Rooms ;
tablelamp in Lamps ;
}
concrete LampsEng of Lamps = {flags coding = utf8 ;flags modulesize = n5 ;lincat Lamp = {s : Str }= {s = str @ 0 } ;"Lamp" ;
lin ceilinglamp : Lamps.Lamp = \ -> {s = "the" ++ ("ceiling" ++ "light")} ;"the ceiling light" ;
lin desklamp : Lamps.Lamp = \ -> {s = "the" ++ ("desk" ++ "light")} ;"the desk light" ;
lin floorlamp : Lamps.Lamp = \ -> {s = "the" ++ ("floor" ++ "light")} ;"the floor light" ;
lin tablelamp : Lamps.Lamp = \ -> {s = "the" ++ ("table" ++ "light")} ;"the table light" ;
}
abstract Lamps = {flags coding = utf8 ;flags modulesize = n5 ;cat Lamp [] = ;
fun ceilinglamp : Lamps.Lamp = {} ;
fun desklamp : Lamps.Lamp = {} ;
fun floorlamp : Lamps.Lamp = {} ;
fun tablelamp : Lamps.Lamp = {} ;
}
concrete RoomsEng of Rooms = {flags coding = utf8 ;flags modulesize = n5 ;lincat Room = {s : Str }= {s = str @ 0 } ;"Room" ;
lin bedroom : Rooms.Room = \ -> {s = "the" ++ "bedroom" } ;"the bedroom" ;
lin hall : Rooms.Room = \ -> {s = "the" ++ "hall" } ;"the hall" ;
lin kitchen : Rooms.Room = \ -> {s = "the" ++ "kitchen" } ;"the kitchen" ;
lin livingroom : Rooms.Room = \ -> {s = "the" ++ ("living" ++ "room")} ;"the living room" ;
}
abstract Rooms = {flags coding = utf8 ;flags modulesize = n5 ;cat Room [] = ;
fun bedroom : Rooms.Room = {} ;
fun hall : Rooms.Room = {} ;
fun kitchen : Rooms.Room = {} ;
fun livingroom : Rooms.Room = {} ;
}
resource SpecResEng = {flags coding = utf8 ;flags modulesize = n2 ;param ItemChoice = Artist | Song | Post ;
param ListInfo = Numeric | Ordered ;
}
